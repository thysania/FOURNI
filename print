import os
from tkinter import Tk, Label, Button
from PIL import ImageTk
from pdf2image import convert_from_path
import win32printing
import subprocess

pdf_file = "recu_06_2025.pdf"

# Convert first page of PDF to image for preview
pages = convert_from_path(pdf_file, dpi=150)
img = ImageTk.PhotoImage(pages[0])

# Print using win32printing (via Adobe Reader or system PDF viewer)
def print_pdf():
    printer = win32printing.get_default_printer()
    subprocess.Popen(['AcroRd32.exe', '/t', pdf_file, printer, '', ''], shell=True)

# GUI
root = Tk()
root.title("Receipt Preview")

Label(root, image=img).pack()
Button(root, text="Print Receipt", command=print_pdf).pack(pady=10)

root.mainloop()